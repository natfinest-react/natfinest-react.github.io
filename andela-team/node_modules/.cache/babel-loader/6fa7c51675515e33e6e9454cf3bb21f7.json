{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nconst initialUser = localStorage.getItem(\"user\") ? JSON.parse(localStorage.getItem(\"user\")) : null;\nexport const initialState = {\n  user: initialUser,\n  loading: false,\n  feeds: []\n}; // A slice of user with our reducers\n\nconst feedsSlice = createSlice({\n  name: \"feeds\",\n  initialState,\n  reducers: {\n    getFeeds: state => {\n      state.loading = true;\n    },\n    getFeedSuccess: (state, action) => {\n      state.feeds = action.payload;\n    },\n    getFeedsFailure: (state, action) => {\n      state.error = action.payload;\n    }\n  }\n}); // Three actions generated from the slice\n\nexport const {\n  getFeeds,\n  getFeedSuccess,\n  getFeedsFailure\n} = feedsSlice.actions; // A selector\n\nexport const feedsSelector = state => state.feeds; // The reducer\n\nexport default feedsSlice.reducer; // Asynchronous thunk action\n// export const fetchFeeds = () => async (dispatch) => {\n//   const token = initialState.user.user.token;\n//   axios\n//     .get(\"http://localhost:5000/api/v1/feed\", {\n//       headers: {\n//         Authorization: \"Bearer \" + token,\n//       },\n//     })\n//     .then((response) => {\n//       // const feed = response.data;\n//       const feed = response.data.data;\n//       console.log(feed);\n//       dispatch(getFeedSuccess({ feed }));\n//     })\n//     .catch((error) => {\n//       const err = error.response.data.error;\n//       dispatch(getFeedsFailure({ err }));\n//     });\n// };\n\nexport function fetchFeeds() {\n  return async dispatch => {\n    dispatch(getFeeds());\n\n    try {\n      const bearer_token = JSON.parse(localStorage.getItem(\"user\")).user.token;\n      const response = await fetch(\"http://localhost:5000/api/v1/feed\", {\n        headers: {\n          authorization: \"Bearer \" + bearer_token\n        }\n      });\n      const data = await response.json();\n      dispatch(getFeedSuccess(data.data));\n    } catch (error) {\n      console.log(error);\n      dispatch(getFeedsFailure());\n    }\n  };\n}","map":{"version":3,"sources":["/Users/user/Documents/Andela_Teamwork_Frontend/frontend/src/slices/feeds.js"],"names":["createSlice","initialUser","localStorage","getItem","JSON","parse","initialState","user","loading","feeds","feedsSlice","name","reducers","getFeeds","state","getFeedSuccess","action","payload","getFeedsFailure","error","actions","feedsSelector","reducer","fetchFeeds","dispatch","bearer_token","token","response","fetch","headers","authorization","data","json","console","log"],"mappings":"AAAA,SAASA,WAAT,QAA4B,kBAA5B;AACA,MAAMC,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,MAArB,IAChBC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CADgB,GAEhB,IAFJ;AAIA,OAAO,MAAMG,YAAY,GAAG;AAC1BC,EAAAA,IAAI,EAAEN,WADoB;AAE1BO,EAAAA,OAAO,EAAE,KAFiB;AAG1BC,EAAAA,KAAK,EAAE;AAHmB,CAArB,C,CAMP;;AACA,MAAMC,UAAU,GAAGV,WAAW,CAAC;AAC7BW,EAAAA,IAAI,EAAE,OADuB;AAE7BL,EAAAA,YAF6B;AAG7BM,EAAAA,QAAQ,EAAE;AACRC,IAAAA,QAAQ,EAAGC,KAAD,IAAW;AACnBA,MAAAA,KAAK,CAACN,OAAN,GAAgB,IAAhB;AACD,KAHO;AAIRO,IAAAA,cAAc,EAAE,CAACD,KAAD,EAAQE,MAAR,KAAmB;AACjCF,MAAAA,KAAK,CAACL,KAAN,GAAcO,MAAM,CAACC,OAArB;AACD,KANO;AAORC,IAAAA,eAAe,EAAE,CAACJ,KAAD,EAAQE,MAAR,KAAmB;AAClCF,MAAAA,KAAK,CAACK,KAAN,GAAcH,MAAM,CAACC,OAArB;AACD;AATO;AAHmB,CAAD,CAA9B,C,CAgBA;;AACA,OAAO,MAAM;AAAEJ,EAAAA,QAAF;AAAYE,EAAAA,cAAZ;AAA4BG,EAAAA;AAA5B,IAAgDR,UAAU,CAACU,OAAjE,C,CAEP;;AACA,OAAO,MAAMC,aAAa,GAAIP,KAAD,IAAWA,KAAK,CAACL,KAAvC,C,CAEP;;AACA,eAAeC,UAAU,CAACY,OAA1B,C,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO,SAASC,UAAT,GAAsB;AAC3B,SAAO,MAAOC,QAAP,IAAoB;AACzBA,IAAAA,QAAQ,CAACX,QAAQ,EAAT,CAAR;;AACA,QAAI;AACF,YAAMY,YAAY,GAAGrB,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,EAAyCI,IAAzC,CAA8CmB,KAAnE;AACA,YAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,mCAAD,EAAsC;AAChEC,QAAAA,OAAO,EAAE;AACPC,UAAAA,aAAa,EAAE,YAAYL;AADpB;AADuD,OAAtC,CAA5B;AAMA,YAAMM,IAAI,GAAG,MAAMJ,QAAQ,CAACK,IAAT,EAAnB;AACAR,MAAAA,QAAQ,CAACT,cAAc,CAACgB,IAAI,CAACA,IAAN,CAAf,CAAR;AACD,KAVD,CAUE,OAAOZ,KAAP,EAAc;AACdc,MAAAA,OAAO,CAACC,GAAR,CAAYf,KAAZ;AACAK,MAAAA,QAAQ,CAACN,eAAe,EAAhB,CAAR;AACD;AACF,GAhBD;AAiBD","sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\nconst initialUser = localStorage.getItem(\"user\")\n  ? JSON.parse(localStorage.getItem(\"user\"))\n  : null;\n\nexport const initialState = {\n  user: initialUser,\n  loading: false,\n  feeds: [],\n};\n\n// A slice of user with our reducers\nconst feedsSlice = createSlice({\n  name: \"feeds\",\n  initialState,\n  reducers: {\n    getFeeds: (state) => {\n      state.loading = true;\n    },\n    getFeedSuccess: (state, action) => {\n      state.feeds = action.payload;\n    },\n    getFeedsFailure: (state, action) => {\n      state.error = action.payload;\n    },\n  },\n});\n\n// Three actions generated from the slice\nexport const { getFeeds, getFeedSuccess, getFeedsFailure } = feedsSlice.actions;\n\n// A selector\nexport const feedsSelector = (state) => state.feeds;\n\n// The reducer\nexport default feedsSlice.reducer;\n\n// Asynchronous thunk action\n// export const fetchFeeds = () => async (dispatch) => {\n//   const token = initialState.user.user.token;\n//   axios\n//     .get(\"http://localhost:5000/api/v1/feed\", {\n//       headers: {\n//         Authorization: \"Bearer \" + token,\n//       },\n//     })\n//     .then((response) => {\n//       // const feed = response.data;\n//       const feed = response.data.data;\n//       console.log(feed);\n//       dispatch(getFeedSuccess({ feed }));\n//     })\n//     .catch((error) => {\n//       const err = error.response.data.error;\n//       dispatch(getFeedsFailure({ err }));\n//     });\n// };\n\nexport function fetchFeeds() {\n  return async (dispatch) => {\n    dispatch(getFeeds());\n    try {\n      const bearer_token = JSON.parse(localStorage.getItem(\"user\")).user.token;\n      const response = await fetch(\"http://localhost:5000/api/v1/feed\", {\n        headers: {\n          authorization: \"Bearer \" + bearer_token,\n        },\n      });\n\n      const data = await response.json();\n      dispatch(getFeedSuccess(data.data));\n    } catch (error) {\n      console.log(error);\n      dispatch(getFeedsFailure());\n    }\n  };\n}\n"]},"metadata":{},"sourceType":"module"}