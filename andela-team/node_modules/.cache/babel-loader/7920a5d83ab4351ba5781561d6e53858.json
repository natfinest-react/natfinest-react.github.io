{"ast":null,"code":"import _regeneratorRuntime from\"/Users/user/Documents/GitHub/natfinest-react.github.io/andela-team/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/user/Documents/GitHub/natfinest-react.github.io/andela-team/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{createSlice}from\"@reduxjs/toolkit\";import url from\"../components/config\";var initialUser=localStorage.getItem(\"user\")?JSON.parse(localStorage.getItem(\"user\")):null;export var initialState={user:initialUser,loading:false,hasErrors:false,articles:[]};// A slice of user with our reducers\nvar articlesSlice=createSlice({name:\"articles\",initialState:initialState,reducers:{getArticles:function getArticles(state){state.loading=true;},getArticlesSuccess:function getArticlesSuccess(state,action){state.articles=action.payload.message;state.loading=false;},getArticlesFailure:function getArticlesFailure(state,action){state.error=action.payload;state.loading=false;},postArticleSuccess:function postArticleSuccess(state,action){// state.articles = action.payload;\n},postArticleFailure:function postArticleFailure(state,action){state.error=action.payload;}}});// Three actions generated from the slice\nvar _articlesSlice$action=articlesSlice.actions,getArticles=_articlesSlice$action.getArticles,getArticlesSuccess=_articlesSlice$action.getArticlesSuccess,getArticlesFailure=_articlesSlice$action.getArticlesFailure,postArticleFailure=_articlesSlice$action.postArticleFailure,postArticleSuccess=_articlesSlice$action.postArticleSuccess;// A selector\nexport{getArticles,getArticlesSuccess,getArticlesFailure,postArticleFailure,postArticleSuccess};export var articlesSelector=function articlesSelector(state){return state.articles;};// The reducer\nexport default articlesSlice.reducer;// Asynchronous thunk action\n// export const fetchFeeds = () => async (dispatch) => {\n//   const token = initialState.user.user.token;\n//   axios\n//     .get(\"http://localhost:5000/api/v1/feed\", {\n//       headers: {\n//         Authorization: \"Bearer \" + token,\n//       },\n//     })\n//     .then((response) => {\n//       // const feed = response.data;\n//       const feed = response.data.data;\n//       console.log(feed);\n//       dispatch(getFeedSuccess({ feed }));\n//     })\n//     .catch((error) => {\n//       const err = error.response.data.error;\n//       dispatch(getFeedsFailure({ err }));\n//     });\n// };\nexport function postArticle(_ref){var form_title=_ref.form_title,form_desc=_ref.form_desc,form_cat=_ref.form_cat,form_share=_ref.form_share;var bearer_token=JSON.parse(localStorage.getItem(\"user\")).user.token;var content={title:form_title,description:form_desc,category:form_cat,share:form_share};return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"\".concat(url,\"/api/v1/articles\"),{method:\"POST\",headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\",authorization:\"Bearer \"+bearer_token},body:JSON.stringify(content)});case 3:response=_context.sent;_context.next=6;return response.json();case 6:data=_context.sent;dispatch(postArticleSuccess(data.data.message));_context.next=15;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.log(JSON.stringify(content));console.log(_context.t0);dispatch(postArticleFailure());case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function(_x){return _ref2.apply(this,arguments);};}();}export function fetchArticles(){var bearer_token=JSON.parse(localStorage.getItem(\"user\")).user.token;return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(getArticles());_context2.prev=1;_context2.next=4;return fetch(\"\".concat(url,\"/api/v1/articles\"),{headers:{authorization:\"Bearer \"+bearer_token}});case 4:response=_context2.sent;_context2.next=7;return response.json();case 7:data=_context2.sent;dispatch(getArticlesSuccess(data.data));_context2.next=15;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0);dispatch(getArticlesFailure());case 15:case\"end\":return _context2.stop();}}},_callee2,null,[[1,11]]);}));return function(_x2){return _ref3.apply(this,arguments);};}();}","map":{"version":3,"sources":["/Users/user/Documents/GitHub/natfinest-react.github.io/andela-team/src/slices/articles.js"],"names":["createSlice","url","initialUser","localStorage","getItem","JSON","parse","initialState","user","loading","hasErrors","articles","articlesSlice","name","reducers","getArticles","state","getArticlesSuccess","action","payload","message","getArticlesFailure","error","postArticleSuccess","postArticleFailure","actions","articlesSelector","reducer","postArticle","form_title","form_desc","form_cat","form_share","bearer_token","token","content","title","description","category","share","dispatch","fetch","method","headers","Accept","authorization","body","stringify","response","json","data","console","log","fetchArticles"],"mappings":"+WAAA,OAASA,WAAT,KAA4B,kBAA5B,CACA,MAAOC,CAAAA,GAAP,KAAgB,sBAAhB,CACA,GAAMC,CAAAA,WAAW,CAAGC,YAAY,CAACC,OAAb,CAAqB,MAArB,EAChBC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CADgB,CAEhB,IAFJ,CAIA,MAAO,IAAMG,CAAAA,YAAY,CAAG,CAC1BC,IAAI,CAAEN,WADoB,CAE1BO,OAAO,CAAE,KAFiB,CAG1BC,SAAS,CAAE,KAHe,CAI1BC,QAAQ,CAAE,EAJgB,CAArB,CAOP;AACA,GAAMC,CAAAA,aAAa,CAAGZ,WAAW,CAAC,CAChCa,IAAI,CAAE,UAD0B,CAEhCN,YAAY,CAAZA,YAFgC,CAGhCO,QAAQ,CAAE,CACRC,WAAW,CAAE,qBAACC,KAAD,CAAW,CACtBA,KAAK,CAACP,OAAN,CAAgB,IAAhB,CACD,CAHO,CAIRQ,kBAAkB,CAAE,4BAACD,KAAD,CAAQE,MAAR,CAAmB,CACrCF,KAAK,CAACL,QAAN,CAAiBO,MAAM,CAACC,OAAP,CAAeC,OAAhC,CACAJ,KAAK,CAACP,OAAN,CAAgB,KAAhB,CACD,CAPO,CAQRY,kBAAkB,CAAE,4BAACL,KAAD,CAAQE,MAAR,CAAmB,CACrCF,KAAK,CAACM,KAAN,CAAcJ,MAAM,CAACC,OAArB,CACAH,KAAK,CAACP,OAAN,CAAgB,KAAhB,CACD,CAXO,CAYRc,kBAAkB,CAAE,4BAACP,KAAD,CAAQE,MAAR,CAAmB,CACrC;AACD,CAdO,CAeRM,kBAAkB,CAAE,4BAACR,KAAD,CAAQE,MAAR,CAAmB,CACrCF,KAAK,CAACM,KAAN,CAAcJ,MAAM,CAACC,OAArB,CACD,CAjBO,CAHsB,CAAD,CAAjC,CAwBA;0BAOIP,aAAa,CAACa,O,CALhBV,W,uBAAAA,W,CACAE,kB,uBAAAA,kB,CACAI,kB,uBAAAA,kB,CACAG,kB,uBAAAA,kB,CACAD,kB,uBAAAA,kB,CAGF;gGACA,MAAO,IAAMG,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACV,KAAD,QAAWA,CAAAA,KAAK,CAACL,QAAjB,EAAzB,CAEP;AACA,cAAeC,CAAAA,aAAa,CAACe,OAA7B,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAO,SAASC,CAAAA,WAAT,MAAsE,IAA/CC,CAAAA,UAA+C,MAA/CA,UAA+C,CAAnCC,SAAmC,MAAnCA,SAAmC,CAAxBC,QAAwB,MAAxBA,QAAwB,CAAdC,UAAc,MAAdA,UAAc,CAC3E,GAAMC,CAAAA,YAAY,CAAG5B,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,EAAyCI,IAAzC,CAA8C0B,KAAnE,CACA,GAAMC,CAAAA,OAAO,CAAG,CACdC,KAAK,CAAEP,UADO,CAEdQ,WAAW,CAAEP,SAFC,CAGdQ,QAAQ,CAAEP,QAHI,CAIdQ,KAAK,CAAEP,UAJO,CAAhB,CAMA,gGAAO,iBAAOQ,QAAP,0KAEoBC,CAAAA,KAAK,WAAIxC,GAAJ,qBAA2B,CACrDyC,MAAM,CAAE,MAD6C,CAErDC,OAAO,CAAE,CACPC,MAAM,CAAE,mCADD,CAEP,eAAgB,kBAFT,CAGPC,aAAa,CAAE,UAAYZ,YAHpB,CAF4C,CAOrDa,IAAI,CAAEzC,IAAI,CAAC0C,SAAL,CAAeZ,OAAf,CAP+C,CAA3B,CAFzB,QAEGa,QAFH,qCAYgBA,CAAAA,QAAQ,CAACC,IAAT,EAZhB,QAYGC,IAZH,eAaHV,QAAQ,CAACjB,kBAAkB,CAAC2B,IAAI,CAACA,IAAL,CAAU9B,OAAX,CAAnB,CAAR,CAbG,iFAeH+B,OAAO,CAACC,GAAR,CAAY/C,IAAI,CAAC0C,SAAL,CAAeZ,OAAf,CAAZ,EACAgB,OAAO,CAACC,GAAR,cACAZ,QAAQ,CAAChB,kBAAkB,EAAnB,CAAR,CAjBG,qEAAP,gEAoBD,CAED,MAAO,SAAS6B,CAAAA,aAAT,EAAyB,CAC9B,GAAMpB,CAAAA,YAAY,CAAG5B,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,EAAyCI,IAAzC,CAA8C0B,KAAnE,CACA,gGAAO,kBAAOM,QAAP,wIACLA,QAAQ,CAACzB,WAAW,EAAZ,CAAR,CADK,wCAGoB0B,CAAAA,KAAK,WAAIxC,GAAJ,qBAA2B,CACrD0C,OAAO,CAAE,CACPE,aAAa,CAAE,UAAYZ,YADpB,CAD4C,CAA3B,CAHzB,QAGGe,QAHH,uCASgBA,CAAAA,QAAQ,CAACC,IAAT,EAThB,QASGC,IATH,gBAUHV,QAAQ,CAACvB,kBAAkB,CAACiC,IAAI,CAACA,IAAN,CAAnB,CAAR,CAVG,qFAYHC,OAAO,CAACC,GAAR,eACAZ,QAAQ,CAACnB,kBAAkB,EAAnB,CAAR,CAbG,uEAAP,iEAgBD","sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\nimport url from \"../components/config\";\nconst initialUser = localStorage.getItem(\"user\")\n  ? JSON.parse(localStorage.getItem(\"user\"))\n  : null;\n\nexport const initialState = {\n  user: initialUser,\n  loading: false,\n  hasErrors: false,\n  articles: [],\n};\n\n// A slice of user with our reducers\nconst articlesSlice = createSlice({\n  name: \"articles\",\n  initialState,\n  reducers: {\n    getArticles: (state) => {\n      state.loading = true;\n    },\n    getArticlesSuccess: (state, action) => {\n      state.articles = action.payload.message;\n      state.loading = false;\n    },\n    getArticlesFailure: (state, action) => {\n      state.error = action.payload;\n      state.loading = false;\n    },\n    postArticleSuccess: (state, action) => {\n      // state.articles = action.payload;\n    },\n    postArticleFailure: (state, action) => {\n      state.error = action.payload;\n    },\n  },\n});\n\n// Three actions generated from the slice\nexport const {\n  getArticles,\n  getArticlesSuccess,\n  getArticlesFailure,\n  postArticleFailure,\n  postArticleSuccess,\n} = articlesSlice.actions;\n\n// A selector\nexport const articlesSelector = (state) => state.articles;\n\n// The reducer\nexport default articlesSlice.reducer;\n\n// Asynchronous thunk action\n// export const fetchFeeds = () => async (dispatch) => {\n//   const token = initialState.user.user.token;\n//   axios\n//     .get(\"http://localhost:5000/api/v1/feed\", {\n//       headers: {\n//         Authorization: \"Bearer \" + token,\n//       },\n//     })\n//     .then((response) => {\n//       // const feed = response.data;\n//       const feed = response.data.data;\n//       console.log(feed);\n//       dispatch(getFeedSuccess({ feed }));\n//     })\n//     .catch((error) => {\n//       const err = error.response.data.error;\n//       dispatch(getFeedsFailure({ err }));\n//     });\n// };\nexport function postArticle({ form_title, form_desc, form_cat, form_share }) {\n  const bearer_token = JSON.parse(localStorage.getItem(\"user\")).user.token;\n  const content = {\n    title: form_title,\n    description: form_desc,\n    category: form_cat,\n    share: form_share,\n  };\n  return async (dispatch) => {\n    try {\n      const response = await fetch(`${url}/api/v1/articles`, {\n        method: \"POST\",\n        headers: {\n          Accept: \"application/json, text/plain, */*\",\n          \"Content-Type\": \"application/json\",\n          authorization: \"Bearer \" + bearer_token,\n        },\n        body: JSON.stringify(content),\n      });\n\n      const data = await response.json();\n      dispatch(postArticleSuccess(data.data.message));\n    } catch (error) {\n      console.log(JSON.stringify(content));\n      console.log(error);\n      dispatch(postArticleFailure());\n    }\n  };\n}\n\nexport function fetchArticles() {\n  const bearer_token = JSON.parse(localStorage.getItem(\"user\")).user.token;\n  return async (dispatch) => {\n    dispatch(getArticles());\n    try {\n      const response = await fetch(`${url}/api/v1/articles`, {\n        headers: {\n          authorization: \"Bearer \" + bearer_token,\n        },\n      });\n\n      const data = await response.json();\n      dispatch(getArticlesSuccess(data.data));\n    } catch (error) {\n      console.log(error);\n      dispatch(getArticlesFailure());\n    }\n  };\n}\n"]},"metadata":{},"sourceType":"module"}